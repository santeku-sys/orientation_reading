# 名前重要

- 英語：Naming is important

## 【どういうこと】コードで命名は最重要課題

プログラミングにおいて、「命名」を最重要課題として認識し、慎重に取り組むようにしましょう。
「名前を付ける行為」、そして、それを経て生まれた「名前そのもの」、両方に重要な価値があります。

### 名前を付ける行為

適切な名前を付けられたということは、その要素が正しく理解されて、正しく設計されたということです。逆にふさわしい名前が付けれないということは、その要素が果たすべき役割についてプログラマ自身が十分理解できていないということです。

適切な名前を付けることができたら、その設計の大部分が完成したと言っても過言ではありません。

### 名前そのもの

名前は、コードを通じて、プログラマ同士がコミュニケーションするための最大の場となります。

コードを書いた人と読む人が同時にいて、「リアルタイムの会話」ができることは稀です。たいていは「コードを通じての会話」となるので、名前が適切でないと、コード上の会話は成り立ちません。

このリアルタイムでないコミュニケーションを円滑にするため、名前には最大限の配慮がなされるべきです。

## 【どうして】コードを読む人への「UI」

名前は、コードを読む人へのユーザインターフェースです。各要素に対して適切に名前の付けられているコードは、その意図するところが伝わり、「何を」「どのように」やっているか明確に理解できます。読むと直ちに意味が分かる、良いユーザインターフェースです。

例えば関数の命名で考えてみます。適切に命名された、わかりやすい名前の関数は、その責務を名前で通知したうえで、内部処理の詳細を隠ぺいしてくれます。その結果、以下のメリットが生まれます。

- コードを読んでいる時、関数名を見ただけで、その処理の概要が把握できるので、適宜読み飛ばすことができます。
- コードを書いている時、その関数を使用する場面においては、名前に導かれ、目的や使用方法がすぐに理解できるので、呼び出すのが簡単です。書きあがったコードは、良い名前のおかげで説明的になっており、読みやすくなっています。

逆にわかりにくい関数があると、そのコード上での作業は大きな負荷がかかります。具体的には以下のような負荷が考えられます。

- コードを読んでいる時、関数名を見ただけで処理内容がわからなければ、それを理解するために、関数の内部を解析しなければならなくなります。つまり、「深く」読むことを強いられるのです。関数の階層が浅ければそれほど問題になりませんが、階層が深くなると、プログラマには大きな負担になります。
- コードを書いている時、使用した関数の名前から、諸々の判断が下せない場合、やはりその内部を解析する必要が出てきます。何とか使用できても、書きあがったコードは、呼び出している関数名が悪いために、支離滅裂で読みにくくなります。

コードを読み書きしている時、プログラマは、常に脳への過負荷と戦っています。プログラマがコードと対峙している時、「どう動いているのか」という詳細で頭がいっぱいになってしまったら、考えがまとまらず、先に進めなくなります。

プログラマはコードを読みたいから読んでいるのではありません。コードを読んで、よく理解したうえで、修正したり、機能追加したりするのが目的です。名前が悪いと、読むことにすべてのリソースが奪われ、取り組むべき本来の作業を妨げられ、課題にたどり着かなくなってしまいます。

名前はこだわると結構な負担になります。適切な名前を付けることは高度な思考能力を必要としますし、時間もかかります。逆に、適当につけても動きますし、そうすれば時間の節約になります。

しかし、不適切な命名は、コードに負債を抱えることと同じです。その後コードが生き続ける限りずっと、コードを読む人コードを使う人すべてにマイナスの影響を与え続けるのです。

## 【どうすれば】コードはまず名前を決める

プログラミングはまず名前から入りましょう。コードに現れる様々な要素に意図が伝わるような名前を付けるようにします。

その際コードを書いていながらも常に「使う側」「読む側」の視点に立って命名してください。具体的には以下の点に注意します。

- 名前にはより多くの情報を詰め込むようにします。名前を「短いコメント」だと考えると、伝えるべき情報が含まれやすくなります。また、複数候補を挙げて、そこから選ぶようにするとよりよい名前になります。
- 名前は誤解されることのないように気を付けます。命名の後、「ほかの意味と間違えられることはないだろうか？」と何度も自問自答することです。誤解を少なくするために、各プログラミング言語の慣例を知り、それに倣うことも必要です。
- 名前は、「効果」と「目的」を説明します。「手段」には言及しません。そうすることでコードを読む人、使う人は、詳細を理解する手間を省くことができます。
- 名前を自分自身でチェックしたい場合、処理を書く前にそのテストを書くようにします。そうすることでコードの使用者側の視点で考えられるようになります。
- 名前は発音可能なものにします。現実の会話で使用しやすく。コードを読むときでも、発音できた方が脳に負担がかかりません。
- 名前は検索可能なものにします。例えば英数字1文字の名前はコード全体で無限にヒットしコードの解析に手間がかかりすぎます。

## 【発展】メンタルマッピング回避

ある情報から記憶の中のあるべき姿のイメージに変換することをメンタルマッピングといいます。

コードを読む人が名前を見て心の中で既知の名前に変換しなければならない、つまりメンタルマッピングしなければならないようなことは極力避けねばなりません。これはコードの流れを追うことに集中したいプログラマの脳に対して非常に負荷をかけ集中を乱します。

メンタルマッピングは「規約」や「問題領域」から外れた用語を使用した場合に発生します。独自の名前を使用すると、それはそのままでは解釈できず、標準的な名前にメンタルマッピングしなければなりません。よって可能な限り標準に基づいた用語で命名します。独自の名前を考えるより標準に従う方が共通認識を利用できるので、書く方も読むほうも楽になります。

またメンタルマッピングは（ループカウンタ以外で）1文字の変数名を使うときも発生します。1文字の変数名は単なるプレースホルダーでしかありません。コードを読む人が、あるべき名前にメンタルマッピングしなければなりません。

プログラマはユーザに対して価値を提供するために自らの能力を使います。命名に関して、知識をひけらかすなど無用な独自性を出すことはありません。ほかの人が理解可能な命名をし、理解しやすいコードを書きましょう。

## 【関連】ループバックチェック

命名について「名前可逆性」という考え方があります。これは「名前はその元となった内容の説明文を復元でき中ればならない」という命名指針のことです。

この条件を満たすために「ループバックチェック」を行います。内容の説明文から名前を考えたら、今度は名前から推測できる説明文を考えるようにするのです。説明→名前→説明の順で1周回って元に戻る（ループバック）ように説明が一致すればよい名前で、一致しなければ要注意となります。

例を挙げて考えてみましょう。「音声を使ってソフトウエアを操作する機能」という説明から名前を考えてみます

- 音声認識機能・・・×  
音声を認識して、それで「操作する」という部分が伝わりません。よって「音声でデータを入力する機能」と受け取られかねません。

- 音声操作機能・・・△  
「音声」と「操作」の関係が伝わりません。よって「音声によって操作する機能」ではなく、「音声を操作する機能」と受け取られかねません。説明文にある単語をそのまま使えばよいというわけでもないのです。

- 音声コントロール機能・・・△  
コントロールという言葉には、「コピーコントロール」のような使い方もあります。よって「音声によって操作する機能」ではなく「音声を制限する機能」と受け取られかねません。

- 音声命令機能・・・○  
「音声を操作する」「音声に対して操作する」という誤解がほぼなくなります。ただしこの名前でも「命令」が「入力音声」ではなく「出力音声」にかかると解釈されてしまう可能性はあります。
